@using SurvivorApp.Models;
@using SurvivorApp.Services;
@page "/survivors"
@inject PersonService personService;
@inject IConfiguration configuration;



<PageTitle>Index</PageTitle>

<h1>Showing Survivors</h1>

<input type="text" @bind-value="@searchLastName" />
<input type="button" value="Search" @onclick="@SearchSurvivors" />
<input type="button" value="Search" @onclick="@GetPersons" />

<table>
    <tr>
        <td style="width:15%">FirstName</td>
        <td style="width:15%">LastName</td>
        <td style="width:10%">Age</td>
        <td style="width:10%">Gender</td>
        <td style="width:10%">LastLat</td>
        <td style="width:10%">LastLong</td>
        <td style="width:10%">Alive</td>
    </tr>

    @if (Persons == null)
    {
        <p><em>Loading...</em></p>
    }
    else
    {

        @foreach (var person in Persons)
        {
            <tr>
                <td>@person.FirstName</td>
                <td>@person.LastName</td>
                <td>@person.Age</td>
                <td>@person.Gender</td>
                <td>@person.LastLatitude</td>
                <td>@person.LastLongitude</td>
                <td>@person.Alive</td>
            </tr>
        }
    }

</table>


@code {


    private List<Person>? Persons;

    private string searchLastName = "";

    protected override async Task OnInitializedAsync()
    {
        await GetPersons();

    }

    async Task SearchSurvivors()
    {
        Persons = await personService.GetPersonsLastName(searchLastName);

    }

    async Task GetPersons()
    {
        Persons = await personService.GetPersons();

    }


}
